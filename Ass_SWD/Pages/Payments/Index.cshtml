@page
@model Ass_SWD.Pages.Payment.IndexModel
@using Ass_SWD.Models
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "_MainLayout";
}


<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
</head>


<body class="mt-5">

    <h2>
        Payment
    </h2>

    <form method="get">
        <table>
            <tr>
                <td width="100">PaymentId</td>
                <td><input name="paymentId" /></td>
            </tr>
            <tr>
                <td></td>
                <td><input style="margin-top:7px" type="submit" value="Search"</td>
            </tr>
        </table>
    </form>

    <table class="table table-bordered" id="tblPayment">
        <thead>
             <tr>
                <th scope="col">PaymentID</th>
                <th scope="col">InvoiceNumber</th>
                <th scope="col">CategoryID</th>
                <th scope="col">RequiredDate</th>
                <th scope="col">PayedDate</th>
                <th scope="col">Partner</th>
                <th scope="col">DepartmentID</th>
                <th scope="col">Amount</th>
                <th scope="col">status</th>
            </tr>
        </thead>
        <tbody>          
            @foreach (var payment in Model.payments)
            {
                <tr>
                    <td>@payment.PaymentId</td>
                    <td>@payment.InvoiceNumber</td>
                    <td>@payment.CategoryId</td>
                    <td>@payment.RequiredDate?.ToString("dd/MM/yyyy")</td>
                    <td>@payment.PayedDate?.ToString("dd/MM/yyyy")</td>
                    <td>@payment.Partner</td>
                    <td>@payment.DepartmentId</td>
                    <td>@payment.Amount</td>
                    @if (payment.Status == true)
                    {
                        <td>Done</td>
                    }
                    else
                    {
                        <td>Processing</td>
                    }
                </tr>
            }


        </tbody>
    </table>

    <a asp-page="/Payments/Create">
        <input type="submit" class="btn btn-primary" value="Add new payment" />
    </a>
   
    <button onclick="tableToExcel()" class="btn btn-primary">Export</button>

    <script type="text/javascript" src="/js/script.js"></script>
    <script type="text/javascript" src="/js/table2excel.js"></script>
   
</body>